{"ast":null,"code":"import { createElementVNode as _createElementVNode, withModifiers as _withModifiers, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"content\"\n};\nconst _hoisted_2 = [\"src\", \"alt\"];\nconst _hoisted_3 = {\n  class: \"meta\"\n};\nconst _hoisted_4 = {\n  class: \"title\"\n};\nconst _hoisted_5 = {\n  class: \"desc\"\n};\nconst _hoisted_6 = {\n  class: \"actions\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", {\n    class: \"bottom-sheet-wrapper\",\n    onClick: _cache[2] || (_cache[2] = _withModifiers($event => _ctx.$emit('close'), [\"self\"]))\n  }, [_createElementVNode(\"div\", {\n    class: _normalizeClass([\"bottom-sheet\", {\n      expanded: $setup.expanded\n    }]),\n    style: _normalizeStyle($setup.sheetStyle),\n    ref: \"sheet\",\n    onPointerdown: $setup.onPointerDown\n  }, [_createElementVNode(\"div\", {\n    class: \"handle\",\n    onClick: _withModifiers($setup.toggle, [\"stop\"])\n  }, [...(_cache[3] || (_cache[3] = [_createElementVNode(\"div\", {\n    class: \"bar\"\n  }, null, -1 /* CACHED */)]))]), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"img\", {\n    class: \"thumb\",\n    src: $props.poi.img,\n    alt: $props.poi.title\n  }, null, 8 /* PROPS */, _hoisted_2), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, _toDisplayString($props.poi.title), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_5, _toDisplayString($props.poi.desc), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"button\", {\n    class: \"primary\",\n    onClick: _cache[0] || (_cache[0] = _withModifiers($event => _ctx.$emit('navigate'), [\"stop\"]))\n  }, \"选定并开始导航\"), _createElementVNode(\"button\", {\n    class: \"secondary\",\n    onClick: _cache[1] || (_cache[1] = _withModifiers($event => _ctx.$emit('detail', $props.poi), [\"stop\"]))\n  }, \"查看详情\")])])])], 38 /* CLASS, STYLE, NEED_HYDRATION */)]);\n}","map":{"version":3,"names":["class","_createElementBlock","onClick","_cache","_withModifiers","$event","_ctx","$emit","_createElementVNode","_normalizeClass","expanded","$setup","style","_normalizeStyle","sheetStyle","ref","onPointerdown","onPointerDown","toggle","_hoisted_1","src","$props","poi","img","alt","title","_hoisted_3","_hoisted_4","_toDisplayString","_hoisted_5","desc","_hoisted_6"],"sources":["E:\\jiangjie-museum\\GitHub\\jiangjie-museum\\src\\components\\PoiBottomCard.vue"],"sourcesContent":["<template>\r\n  <div class=\"bottom-sheet-wrapper\" @click.self=\"$emit('close')\">\r\n    <div\r\n      class=\"bottom-sheet\"\r\n      :class=\"{ expanded }\r\n      \"\r\n      :style=\"sheetStyle\"\r\n      ref=\"sheet\"\r\n      @pointerdown=\"onPointerDown\"\r\n    >\r\n      <div class=\"handle\" @click.stop=\"toggle\">\r\n        <div class=\"bar\"></div>\r\n      </div>\r\n\r\n      <div class=\"content\">\r\n        <img class=\"thumb\" :src=\"poi.img\" :alt=\"poi.title\" />\r\n        <div class=\"meta\">\r\n          <div class=\"title\">{{ poi.title }}</div>\r\n          <div class=\"desc\">{{ poi.desc }}</div>\r\n          <div class=\"actions\">\r\n            <button class=\"primary\" @click.stop=\"$emit('navigate')\">选定并开始导航</button>\r\n            <button class=\"secondary\" @click.stop=\"$emit('detail', poi)\">查看详情</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n/* eslint-env vue/setup-compiler-macros */\r\nimport { ref, onMounted, onBeforeUnmount, watch, computed } from 'vue'\r\ndefineProps({\r\n  poi: { type: Object, required: true }\r\n})\r\nconst emit = defineEmits(['close','navigate','detail'])\r\n\r\nconst sheet = ref(null)\r\nconst expanded = ref(false)\r\nlet startY = 0\r\nlet currentY = 0\r\nlet lastY = 0\r\nlet dragging = false\r\nlet maxTranslate = 0\r\n\r\n// 监听展开状态并通知父组件\r\nwatch(expanded, v => {\r\n  emit('expanded', !!v)\r\n})\r\n\r\nfunction updateMaxTranslate(){\r\n  const el = sheet.value\r\n  if(!el) return\r\n  maxTranslate = el.clientHeight - 96 // collapsed height ~96px\r\n}\r\n\r\nfunction onPointerDown(e){\r\n  dragging = true\r\n  startY = e.clientY\r\n  lastY = startY\r\n  document.addEventListener('pointermove', onPointerMove)\r\n  document.addEventListener('pointerup', onPointerUp)\r\n  sheet.value.style.transition = 'none'\r\n}\r\nfunction onPointerMove(e){\r\n  if(!dragging) return\r\n  currentY = e.clientY\r\n  const delta = currentY - startY\r\n  // if expanded, allow dragging down to collapse; if collapsed, dragging up expands\r\n  let translate = (expanded.value ? 0 : maxTranslate) + delta\r\n  translate = Math.max(0, Math.min(maxTranslate, translate))\r\n  sheet.value.style.transform = `translateY(${translate}px)`\r\n  lastY = currentY\r\n}\r\nfunction onPointerUp(){\r\n  dragging = false\r\n  document.removeEventListener('pointermove', onPointerMove)\r\n  document.removeEventListener('pointerup', onPointerUp)\r\n  sheet.value.style.transition = ''\r\n  const deltaTotal = lastY - startY\r\n  // if dragged more than 40px, toggle\r\n  if(Math.abs(deltaTotal) > 40){\r\n    if(deltaTotal < 0){ // dragged up\r\n      expanded.value = true\r\n    }else{ // dragged down\r\n      expanded.value = false\r\n    }\r\n  }else{\r\n    expanded.value = !expanded.value\r\n  }\r\n  // reset transform\r\n  sheet.value.style.transform = ''\r\n  // emit expanded change happens via watch\r\n}\r\n\r\nfunction toggle(){\r\n  expanded.value = !expanded.value\r\n  // notify parent immediately (watch also covers changes)\r\n  emit('expanded', !!expanded.value)\r\n}\r\n\r\nonMounted(()=>{\r\n  updateMaxTranslate()\r\n  window.addEventListener('resize', updateMaxTranslate)\r\n  // notify initial collapsed state\r\n  emit('expanded', !!expanded.value)\r\n})\r\nonBeforeUnmount(()=>{\r\n  window.removeEventListener('resize', updateMaxTranslate)\r\n})\r\n\r\nconst sheetStyle = computed(()=>({\r\n  bottom: '0',\r\n  // when expanded, full height; when collapsed, show only 96px height visual\r\n  height: expanded.value ? '50vh' : '96px'\r\n}))\r\n</script>\r\n\r\n<style scoped>\r\n.bottom-sheet-wrapper{position:fixed;left:0;right:0;bottom:0;top:0;z-index:80;display:flex;align-items:flex-end;justify-content:center;pointer-events:auto}\r\n.bottom-sheet-wrapper::before{content:'';position:absolute;inset:0;background:transparent}\r\n.bottom-sheet{position:relative;background:#fff;border-top-left-radius:14px;border-top-right-radius:14px;width:100%;max-width:680px;box-shadow:0 -12px 36px rgba(0,0,0,0.12);overflow:hidden;transition:height .28s cubic-bezier(.2,.9,.3,1),transform .18s ease}\r\n.handle{height:36px;display:flex;align-items:center;justify-content:center;cursor:pointer}\r\n.handle .bar{width:42px;height:6px;background:#e6e6e6;border-radius:6px}\r\n.content{display:flex;gap:12px;padding:8px 16px 18px;align-items:center}\r\n.thumb{width:84px;height:64px;border-radius:8px;object-fit:cover;box-shadow:0 8px 22px rgba(0,0,0,0.12)}\r\n.meta{flex:1}\r\n.title{font-weight:700;margin-bottom:6px}\r\n.desc{font-size:12px;color:#666;margin-bottom:8px}\r\n.actions{display:flex;gap:10px}\r\n.primary{background:#d8332a;color:#fff;border:none;padding:8px 12px;border-radius:8px}\r\n.secondary{background:#f5f5f5;border:none;padding:8px 12px;border-radius:8px}\r\n\r\n/* expanded layout tweaks */\r\n.bottom-sheet.expanded{height:50vh}\r\n\r\n@media (max-width:420px){\r\n  .bottom-sheet{border-radius:12px}\r\n  .thumb{width:68px;height:52px}\r\n}\r\n</style>"],"mappings":";;EAcWA,KAAK,EAAC;AAAS;;;EAEbA,KAAK,EAAC;AAAM;;EACVA,KAAK,EAAC;AAAO;;EACbA,KAAK,EAAC;AAAM;;EACZA,KAAK,EAAC;AAAS;;uBAlB5BC,mBAAA,CAyBM;IAzBDD,KAAK,EAAC,sBAAsB;IAAEE,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,cAAA,CAAAC,MAAA,IAAOC,IAAA,CAAAC,KAAK;MAClDC,mBAAA,CAuBM;IAtBJR,KAAK,EAAAS,eAAA,EAAC,cAAc;MAAAC,QAAA,EACVC,MAAA,CAAAD;IAAQ,E;IAEjBE,KAAK,EAAAC,eAAA,CAAEF,MAAA,CAAAG,UAAU;IAClBC,GAAG,EAAC,OAAO;IACVC,aAAW,EAAEL,MAAA,CAAAM;MAEdT,mBAAA,CAEM;IAFDR,KAAK,EAAC,QAAQ;IAAEE,OAAK,EAAAE,cAAA,CAAOO,MAAA,CAAAO,MAAM;qCACrCV,mBAAA,CAAuB;IAAlBR,KAAK,EAAC;EAAK,0B,MAGlBQ,mBAAA,CAUM,OAVNW,UAUM,GATJX,mBAAA,CAAqD;IAAhDR,KAAK,EAAC,OAAO;IAAEoB,GAAG,EAAEC,MAAA,CAAAC,GAAG,CAACC,GAAG;IAAGC,GAAG,EAAEH,MAAA,CAAAC,GAAG,CAACG;uCAC5CjB,mBAAA,CAOM,OAPNkB,UAOM,GANJlB,mBAAA,CAAwC,OAAxCmB,UAAwC,EAAAC,gBAAA,CAAlBP,MAAA,CAAAC,GAAG,CAACG,KAAK,kBAC/BjB,mBAAA,CAAsC,OAAtCqB,UAAsC,EAAAD,gBAAA,CAAjBP,MAAA,CAAAC,GAAG,CAACQ,IAAI,kBAC7BtB,mBAAA,CAGM,OAHNuB,UAGM,GAFJvB,mBAAA,CAAwE;IAAhER,KAAK,EAAC,SAAS;IAAEE,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,cAAA,CAAAC,MAAA,IAAOC,IAAA,CAAAC,KAAK;KAAc,SAAO,GAC/DC,mBAAA,CAA0E;IAAlER,KAAK,EAAC,WAAW;IAAEE,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,cAAA,CAAAC,MAAA,IAAOC,IAAA,CAAAC,KAAK,WAAWc,MAAA,CAAAC,GAAG;KAAG,MAAI,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}